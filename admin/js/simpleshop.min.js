/*! SimpleShop 1.0.0 compiled on 2014-11-24 */
(function($){(function(){this.SimpleShop||(this.SimpleShop={}),SimpleShop.init=function(){return SimpleShop.events(),SimpleShop.initVariants(),SimpleShop.initPricing()},SimpleShop.events=function(){var a;return a=$(".variants, .pricing"),a.on("click",".add",function(){return $(this).closest(".pricing").length?SimpleShop.addPricingTier():SimpleShop.addVariant(),!1}),a.on("click",".remove",function(){return confirm("Are you sure you want to delete this row?")&&$(this).closest("tr").remove(),!1}),a.on("keyup",".attribute",function(){var a;return a=SimpleShop.parameterize($(this).val()),$(this).closest("tr").find(".permalink").val(a)}),a.on("blur",".is_decimal",function(){var a;return $(this).val().length?(a=parseFloat($(this).val()),$(this).val(a.toFixed(2))):void 0})},$(document).ready(SimpleShop.init),this.SimpleShop||(this.SimpleShop={}),SimpleShop.parameterize=function(a){return a.trim().replace(/[^a-zA-Z0-9-\s]/g,"").replace(/[^a-zA-Z0-9-]/g,"-").toLowerCase()},this.SimpleShop||(this.SimpleShop={}),SimpleShop.variantSelects=[],SimpleShop.initPricing=function(){var a,b,c,d,e;for(a=JSON.parse($(".pricing").attr("data-pricing")),e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push(SimpleShop.addPricingTier(b));return e},SimpleShop.initVariants=function(){var a,b,c,d,e;for(b=JSON.parse($(".variants").attr("data-variants")),e=[],c=0,d=b.length;d>c;c++)a=b[c],e.push(SimpleShop.addVariant(a));return e},SimpleShop.setSelectize=function(a){var b,c;return c=a.closest(".pricing").length?"pricing":"variants","variants"===c?a.find(".variants_selectize").selectize({plugins:["remove_button"],create:!0,persist:!1,onItemRemove:function(b){var c;return c=a.find(".permalink").val(),$("input.pricing_selectize").each(function(){return $(this)[0].selectize.removeItem(""+c+";"+b),$(this)[0].selectize.getValue().length?void 0:$(this).closest("tr").remove()})},onItemAdd:function(b){var c,d,e;return e=a.find(".permalink").val(),c=a.find(".attribute").val(),d={text:""+c+" - "+b,value:""+e+";"+b},$("input.pricing_selectize").each(function(){var a;return a=$(this)[0].selectize,a.addOption(d)})}}):"pricing"===c?(b=a.find("input.pricing_selectize"),b.selectize({plugins:["remove_button"],create:!1,persist:!1,options:SimpleShop.getVariants()})):void 0},SimpleShop.getVariants=function(){var a;return a=[],$(".variants .variant").each(function(){var b,c,d;return d=$(this).find(".permalink").val(),b=$(this).find(".attribute").val(),c=$(this).find(".options")[0].selectize.getValue().split(","),c.forEach(function(c){return""!==c?a.push({text:""+b+" - "+c,value:""+d+";"+c}):void 0})}),a},SimpleShop.getTemplate=function(a){var b;return b=a.find(".template").clone(),[$(b.html()),a.find("tbody:last")]},SimpleShop.addPricingTier=function(a){var b,c,d,e,f,g,h,i,j;if(null==a&&(a={}),j=SimpleShop.getTemplate($(".pricing")),b=j[0],f=j[1],a==={}&&!$(".variant").length)return alert("You haven't added any variants yet. You can do so in the Variants box."),!1;for(c in a)if(g=a[c],"options"===c){for(e=[],h=0,i=g.length;i>h;h++)d=g[h],e.push([d.attribute,d.value].join(";"));b.find("."+c).val(e.join(","))}else b.find("."+c).val(g);return SimpleShop.updateRowNames(f,b),b.appendTo(f),SimpleShop.setSelectize(b)},SimpleShop.addVariant=function(a){var b,c,d,e,f;null==a&&(a={}),f=SimpleShop.getTemplate($(".variants")),b=f[0],d=f[1];for(c in a)e=a[c],b.find("."+c).val("options"===c?e.join(","):e);return SimpleShop.updateRowNames(d,b),b.appendTo(d),SimpleShop.setSelectize(b)},SimpleShop.updateRowNames=function(a,b){var c;return c=a.find("tr").length,b.find("[name]").each(function(){var a;return a=$(this).attr("name"),a=a.replace(/\[\]/g,"["+c+"]"),$(this).attr("name",a)})}}).call(this);})(jQuery);