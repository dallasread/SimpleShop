/*! SimpleShop 1.0.0 compiled on 2014-11-26 */
(function($){(function(){this.SimpleShop||(this.SimpleShop={}),SimpleShop.checkout=function(){return SimpleShop.geocode(),$(".checkout").length?(Stripe.setPublishableKey(SimpleShopAjax.stripe_publishable),$(document).on("submit",".checkout",function(){var a;return a=$(this),a.find("button").prop("disabled",!0),$("#card_token_is_set").length?void 0:(Stripe.card.createToken(a,function(b,c){return c.error?(alert(c.error.message),a.find("button").prop("disabled",!1)):(a.append($('<input type="hidden" name="card_token">').val(c.id)),a.append($('<input type="hidden" name="last_four">').val(c.card.last4)),a.get(0).submit())}),!1)}),$(".checkout").on("click",".change_card",function(){return $("#card_token_is_set").remove(),$(".no_card_fields").hide(),$(".card_fields").show(),!1})):void 0},SimpleShop.geocode=function(){var a,b,c;return c=$("#full_address"),c.length?(b={street_number:"short_name",route:"long_name",locality:"long_name",administrative_area_level_1:"short_name",country:"long_name",postal_code:"short_name"},a=new google.maps.places.Autocomplete(c[0],{types:["geocode"]}),google.maps.event.addListener(a,"place_changed",function(){var c,d,e,f,g;for(f=a.getPlace(),d={},e=0;e<f.address_components.length;)c=f.address_components[e].types[0],b[c]&&(g=f.address_components[e][b[c]],d[c]=g),e++;return d!=={}?($("#address").val(""+d.street_number+" "+d.route),$("#city").val(d.locality),$("#province").val(d.administrative_area_level_1),$("#postal_code").val(d.postal_code),$("#country").val(d.country)):void 0})):void 0},$(document).ready(SimpleShop.checkout),this.SimpleShop||(this.SimpleShop={}),SimpleShop.serializeObject=function(a){var b;return b={},$.each(a.serializeArray(),function(a,c){var d,e;d=c.name,e=c.value,b[d]=void 0===b[d]?e:$.isArray(b[d])?b[d].concat(e):[b[d],e]}),b},SimpleShop.events=function(){var a,b;return a=$(".add_to_cart"),b=$(".cart"),a.on("change","input, select",function(){var a,b,c;return c=$(this).closest("form"),a=c.find("button[type='submit']"),a.prop("disabled",!0),b=SimpleShop.serializeObject(c),b.action="calculate_product_price",$.post(SimpleShopAjax.ajaxurl,b,function(b){var d;return d=JSON.parse(b),c.find(".price").text(d.clean_price),a.prop("disabled",!1)})}),b.on("click","#local",function(){var a;return a=b.find("button[type='submit']"),a.prop("disabled",!0),$.post(SimpleShopAjax.ajaxurl,{action:"pickup_locally",local:$(this).is(":checked")},function(c){var d;return d=JSON.parse(c),b.find(".subtotal").text(d.subtotal),b.find(".shipping").text(d.shipping),b.find(".tax").text(d.tax),b.find(".total").text(d.total),b.find(".clean_total").text(d.clean_total),a.prop("disabled",!1)})}),b.on("change",".quantity",function(){var a,c;return c=$(this).closest("tr"),a=b.find("button[type='submit']"),a.prop("disabled",!0),$.post(SimpleShopAjax.ajaxurl,{action:"change_quantity",item_id:c.attr("data-item-id"),quantity:$(this).val()},function(d){var e;return e=JSON.parse(d),b.find(".subtotal").text(e.subtotal),b.find(".shipping").text(e.shipping),b.find(".tax").text(e.tax),b.find(".total").text(e.total),b.find(".clean_total").text(e.clean_total),c.find(".price").text(e.item_price),a.prop("disabled",!1)})}),$(document).on("click",".simpleshop_swatch",function(){var a,b;return a=$(this).attr("data-colour"),b=$(this).attr("data-id"),$(this).closest(".field").find(".simpleshop_swatch.selected").removeClass("selected"),$(this).addClass("selected"),$("#"+b).val(a).trigger("change"),!1})},$(document).ready(SimpleShop.events)}).call(this);})(jQuery);